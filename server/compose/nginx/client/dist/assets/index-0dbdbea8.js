import{a as m}from"./axios-707ed124.js";import{k as v,x as U,r as $,o as T,a as I,c as E,b as f,d as p}from"./index-d5fdc465.js";const h={leftToolbar:' left-toolbar=" undo redo todo-list clear emoji | tip h bold italic strikethrough quote | ul ol table hr | link image media file code  | save ',rightToolbar:" preview toc sync-scroll fullscreen ",disabledMenus:[]};const F={style:{width:"100%",height:"100%"}},z={__name:"index",props:{height:{type:Number,default(){return 400}},placeholder:{type:String,default(){return"请输入内容"}},mode:{type:String,default(){return"editable"}},mdContent:{type:String,default(){return""}}},emits:["update:value"],setup(u,{emit:g}){const w=u,s=v(""),i=v(null),b={media:{title:"媒体文件",icon:"v-md-icon-open-in-new",itemWidth:"56px",rowNum:5,menus:[{name:"在线音频文件",text:"在线音频地址",action(){let e='<audio src="在线音频地址" controls></audio>';i.value.insert(n=>({text:e,selected:e}))}},{name:"在线视频文件",text:"在线视频地址",action(){let e='<video src="在线视频地址" width="720" height="auto" controls></video>';i.value.insert(n=>({text:e,selected:e}))}},{name:"上传本地文件",text:"本地媒体文件",action(){const t=document.createElement("input");t.type="file",t.click(),t.addEventListener("change",function(o){const l=o.target.files[0],d=["video/mp4","video/webm"],a=["audio/mpeg","audio/wav"];d.includes(l.type)?e(l):a.includes(l.type)?n(l):console.error("不支持的文件类型")});function e(o){let l=new FormData;l.append("file",o,o.name);let d={headers:{"Content-Type":"multipart/form-data",authorization:p.get("token")}};m.post("/v1/common/files/upload/",l,d).then(a=>{if(a.data.status){let r=`<video src="${a.data.data.previewUrl||a.data.data.downloadUrl}" width="720" height="auto" controls></video>`;i.value.insert(_=>({text:r,selected:r}))}})}function n(o){let l=new FormData;l.append("file",o,o.name);let d={headers:{"Content-Type":"multipart/form-data",authorization:p.get("token")}};m.post("/v1/common/files/upload/",l,d).then(a=>{if(a.data.status){let r=`<audio src="${a.data.data.previewUrl||a.data.data.downloadUrl}" controls></audio>`;i.value.insert(_=>({text:r,selected:r}))}})}}}]},file:{title:"上传其他文件",icon:"v-md-icon-open-in-new",itemWidth:"56px",rowNum:5,menus:[{name:"在线其他类型文件",text:"在线其他类型文件地址",action(){let e="[其他类型文件名称](在线其他类型文件地址)";i.value.insert(n=>({text:e,selected:e}))}},{name:"上传本地其他类型文件",text:"上传本地其他类型文件",action(){const t=document.createElement("input");t.type="file",t.click(),t.addEventListener("change",function(e){const n=e.target.files[0];let o=new FormData;o.append("file",n,n.name);let l={headers:{"Content-Type":"multipart/form-data",authorization:p.get("token")}};m.post("/v1/common/files/upload/",o,l).then(d=>{if(d.data.status){let a=d.data.data.previewUrl||d.data.data.downloadUrl,c=`[${n.name}](${a})`;i.value.insert(r=>({text:c,selected:c}))}})})}}]}};U(()=>{s.value=w.mdContent});const x=t=>{let e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("Copy"),e.remove()},y=(t,e,n)=>{let o=n[0],l=new FormData;l.append("file",o,o.name);let d={headers:{"Content-Type":"multipart/form-data",authorization:p.get("token")}};m.post("/v1/common/files/upload/",l,d).then(a=>{a.data.status&&i.value.insert(c=>({text:`<a href="${a.data.data.previewUrl}" target="_blank">
<img src="${a.data.data.previewUrl}" alt="${a.data.data.filename}" width="750">
</a>`,selected:s}))})},C=(t,e)=>{window.open(t[e])},k=t=>{g("update:value",t)};return(t,e)=>{const n=$("v-md-editor");return T(),I("section",F,[E(n,{ref_key:"editor",ref:i,modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),height:u.height+"px",mode:u.mode,placeholder:u.placeholder,toolbar:b,"left-toolbar":f(h).leftToolbar,"right-toolbar":f(h).rightToolbar,"disabled-menus":f(h).disabledMenus,onChange:k,onImageClick:C,onUploadImage:y,onCopyCodeSuccess:x},null,8,["modelValue","height","mode","placeholder","left-toolbar","right-toolbar","disabled-menus"])])}}};export{z as default};
