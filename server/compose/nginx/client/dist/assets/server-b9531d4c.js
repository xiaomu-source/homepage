import{a as d}from"./axios-707ed124.js";import{d as i,Z as o,a5 as m}from"./index-dca43598.js";const a=d.create({timeout:5e3});a.interceptors.request.use(e=>(e.headers.authorization=i.get("token"),e),e=>Promise.reject());a.interceptors.response.use(e=>{const s=e.headers["content-type"];if(s==="application/octet-stream"||s==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")u(e);else return Promise.resolve(e.data)},e=>p(e));const u=e=>{const s=window.URL.createObjectURL(new Blob([e.data])),t=e.headers["x-filename"];d.get(s,{responseType:"blob"}).then(r=>{const c=new Blob([r.data]);if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(c,decodeURIComponent(t));else{const l=document.createElement("a");l.href=window.URL.createObjectURL(c),l.setAttribute("download",decodeURIComponent(t)),l.click(),l.remove(),window.URL.revokeObjectURL(s)}})},p=e=>{if(e.response)switch(e.response.status){case 400:return console.error("参数校验失败:",e.response.data.message),o.error(e.response.data.message||"参数校验失败"),Promise.reject(e.response.data.message??"参数json解析失败");case 401:return console.error("未授权:",e.response.data.message),e.response.data.message==="Token不存在或已过期"?(m.replace("/login"),o.error("账号已过期,请重新登录"),Promise.reject({error:"Unauthorized",message:"账号已过期,请重新登录"})):(o.error(e.response.data.message||"账号已过期,请重新登录"),Promise.reject({error:"401",message:e.response.data.message}));case 404:return console.error("404:",e.response.data.message),o.error(e.response.data.message||"资源不存在"),Promise.reject({error:"接口不存在",message:e.response.data.message});case 500:return console.error("服务器内部错误:",e.response.data.message),o.error(e.response.data.message||"服务器内部错误"),Promise.reject({error:"服务器内部错误",message:e.response.data.message});default:o.error("服务器响应错误"),console.error("服务器响应错误:",e.response.data)}else e.request?(console.error("请求未收到响应:",e.request),o.error("请求未收到响应")):(console.error("请求配置出错:",e.message),o.error("请求配置出错"))};class n{constructor(){if(n.instance)return n.instance;n.instance=this}get(s,t=null){return a.request({method:"get",url:s,params:t})}post(s,t=null,r=null,c){return a.request({method:"post",url:s,data:t,params:r,responseType:c})}put(s,t=null,r=null){return a.request({method:"put",url:s,data:t,params:r})}delete(s,t=null){return a.request({method:"delete",url:s,params:t})}}const w=new n;export{w as a};
