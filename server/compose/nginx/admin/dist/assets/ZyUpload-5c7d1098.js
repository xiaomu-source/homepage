import{G as L,L as U,d as _,r as l,o as y,e as k,w as c,c as p,g as b,Z as C}from"./index-f1427884.js";import{a as r}from"./server-a5514b00.js";const R=s=>r.get("/v1/common/files/delete/img/"+s),x=s=>r.get("/v1/common/files/delete/media/"+s),I=s=>r.get("/v1/common/files/delete/files/"+s),B={__name:"ZyUpload",props:{url:{type:String},showUploadList:{type:Boolean,default(){return!1}}},emits:["update:url","uploadChange"],setup(s,{emit:i}){const u=s,a=L({fileList:[],showUploadListOpt:!1});U(()=>u.url,e=>{let t={uid:"1",name:"图片.png",status:"done",response:{},url:e};a.fileList.push(t)});const m={authorization:_.get("token")},h=({file:e,fileList:t})=>{e.status==="error"&&C.error(e.response.message||"上传失败"),e.status==="done"&&(i("update:url",e.response.data.previewUrl),i("uploadChange",e))},f=e=>{var o,n;if(!((n=(o=e.response)==null?void 0:o.data)!=null&&n.filename))return console.log("删除失败");let t=null;e.type.startsWith("image/")&&e.type!=="image/svg+xml"?t=R:e.type.startsWith("video/")?t=x:t=I,console.log(e),t(e.response.data.filename).then(d=>{})},w=e=>{let t=e.response.data.downloadUrl;const o=document.createElement("a");o.href=t,o.click(),o.remove(),window.URL.revokeObjectURL(t)},g=e=>{let t=e.response.data.previewUrl;if(!t)return;const o=document.createElement("a");o.href=t,o.setAttribute("target","_blank"),o.click(),o.remove(),window.URL.revokeObjectURL(t)};return(e,t)=>{const o=l("IconFont"),n=l("a-button"),d=l("a-upload");return y(),k(d,{"file-list":a.fileList,"onUpdate:fileList":t[0]||(t[0]=v=>a.fileList=v),headers:m,onChange:h,onPreview:g,onDownload:w,onRemove:f,"list-type":"picture",showUploadList:s.showUploadList?{showDownloadIcon:!0,showRemoveIcon:!0}:!1,action:"/v1/common/files/upload/"},{default:c(()=>[p(n,{size:"small",type:"primary"},{default:c(()=>[p(o,{type:"icon-upload"}),b(" 上传 ")]),_:1})]),_:1},8,["file-list","showUploadList"])}}};export{B as _};
